# Design Pattern(C++)

## 设计模式原则
1. 依赖倒置原则:高层模块不应该依赖于低层模块,二者都应该依赖于抽象;抽象不应该依赖于实现细节,实现细节应该依赖于抽象.
2. 开闭原则:对扩展开放，对修改关闭;类应该是可扩展的,不可修改的.
3. 单一职责原则:每个类实现单一职责,一个类应该仅有一个引起它变化的原因.
4. 里氏替换原则:任何基类可以出现的地方，派生类一定可以出现.
5. 接口隔离原则:每个接口中不存在子类不需要但是必须实现的方法.
6. 合成复用原则:尽量使用合成/聚合的方式，而不是使用继承.
7. 迪米特法则:一个类对自己依赖的类知道得越少越好。也就是说无论被依赖的类多么复杂，都应该将逻辑封装在方法内部，通过public方法提供给外部，这样当方法变化时，才能最小影响该类。
8. 针对接口编程而不是针对实现编程:不将变量类型声明为某个特定的具体类,而是声明为某个接口;客户程序无需知道对象的具体类型,只需要知道对象所具有的接口;减少系统中各部分的依赖关系,从而实现"高内聚、低耦合"的类型设计方案.

## 设计模式分类
### 目的
- 创建型:将对象的创建工作延后到其他类或者其他对象,从而应对需求变化为对象创建带来的冲击.
- 结构型:通过类的继承或对象组合,获得更灵活的结构,从而应对需求变化为对象的结构带来的冲击.
- 行为型:划分类的职责.

### 封装
- 组件协作
  通过晚期绑定来实现框架与应用程序之间的松耦合,是二者之间协作时常用的模式.
  1. 模板方法:整体操作稳定,子步骤有很多改变.
  2. 策略模式:某些对象使用的算法多种多样，经常改变。
  3. 观察者模式\组件模式:为某些对象建立一种"通知依赖关系",一个对象(目标对象)的状态发生改变时,所有依赖对象(观察者对象)都将得到通知.
- 单一职责
  划清职责,减少子类膨胀.=>继承加组合
  1. 装饰模式:根据需要动态扩展对象的功能，同时避免扩展功能增多带来子类膨胀的问题,从而使得任何功能扩展变化所导致的影响降为最低.
  2. 桥模式:对于某些类型的固有的实现逻辑,使得它们具有两个变化的维度,乃至多个维度的变化.
- 对象创建
  通过对象创建模式绕开new,来避免对象创建过程中所导致的紧耦合(依赖具体类),从而支持对象创建的稳定.它是接口抽象之后的第一步工作.
  1. 工厂方法:定义一个用于创建对象的接口,让子类 决定实例化哪一个类,使得一个类的实例化延迟到子类.
  2. 抽象工厂:提供一个接口,让该接口复杂创建一系列相关或相互依赖的对象,无需指定它们的具体类.
  3. 原型模式:拷贝构造,保持对象克隆时的状态.
  4. 构建器:将一个复杂对象的构建和表示相分离,使得同样的构建模式可以创建不同表现的对象.(与模板模式非常相似)
- 对象性能
  1. 单件模式:
  2. 享元模式:对象之间共享一些资源.
- 接口隔离
  1. 门面模式:为子系统中的一组接口提供一个一致(稳定)的界面,门面模式定义了一个高层接口,这个接口使得这一子系统更加容易复用.
  ![门面模式类图](/接口隔离/门面模式类图.png)
  2. 代理模式:为其他对象提供一种代理,以控制(隔离,使用接口)对这个对象的访问.
  ![代理模式类图](/接口隔离/代理模式类图.png)
  3. 适配器:将一个类的接口转换成客户希望的另一个接口.
  ![适配器模式类图](/接口隔离/适配器模式类图.png)
  4. 中介者:用一个中介对象来封装(封装变化)一系列的对象交互.
  ![中介者模式类图](/接口隔离/中介者模式类图.png)
- 状态变化
  1. 状态模式:允许一个对象在其内部状态改变时改变它的行为,从而使对象看起来似乎修改了其行为.
  2. 备忘录模式:在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保持这个状态，这样以后就可以将该对象恢复到原先保持的状态.
- 数据结构
  常常有一些组件内部具有特定的数据结构,如果让客户程序以来这些特定的数据结构,将极大地破坏组件的复用性.这时候将这些特定的数据结构封装在内部,在外部提供统一接口,来实现与特定数据结构无关的访问,是一种行之有效的解决方案.
  1. 组合模式:将对象组合成树形结构一表示"部分整体"的层次结构.组合模式使得用户对单个对象和组合对象的使用具有一致性(稳定).
  2. 迭代器模式
  3. 职责链模式
- 行为变化
- 领域问题

## 重构获得模式
- 参考书籍:《重构——改善既有代码的设计》、《重构与模式》

## 重构关键法
- 静态      ->  动态
- 早绑定    ->  晚绑定
- 继承      ->  组合
- 编译时依赖->  运行时依赖
- 紧耦合    ->  松耦合

## 心得
- 继承获取基类接口规范,而组合获取接口内容.(装饰模式)